<!DOCTYPE HTML>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="theme-color" content="#00878F">
  <link rel="icon" href="img/favicon.ico">
  <title class="translatable_title">Kniwwelino</title>

  <!-- Materialize, Prettify, and Ardublockly CSS -->
  <link rel="stylesheet" href="materialize/materialize.css" media="screen,projection">
  <link rel="stylesheet" href="prettify/arduino.css">
  <link rel="stylesheet" href="ardublockly.css" media="screen,projection">
  <link rel="stylesheet" href="font/font-awesome-4.7.0/css/font-awesome.min.css">
	<!-- led matrix editor -->
	<link rel="stylesheet" href="ledmatrix.css">
  <link rel="stylesheet" href="tutorial/tutorial.css">
	<!-- <script src="http://code.jquery.com/jquery-2.2.3.min.js"></script> -->
  <!-- bootstrap --><!-- TODO check sideeffect with the led matrix position! -->
  <!-- <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"> -->

  <script src="./js_libs/underscore-min.js"></script>
  <script src="./js_libs/sweetalert.min.js"></script>

  <!-- Ardublockly - These three files contain the compress version -->
  <!--<script src="../blockly/blockly_compressed.js"></script>
  <script src="../blockly/blocks_compressed.js"></script>
  <script src="../blockly/arduino_compressed.js"></script>-->
  <!-- To use the uncompressed version comment out the above and comment in the ones below -->
  <script src="../blockly/blockly_uncompressed.js"></script>
  <script src="../blockly/blocks/logic.js"></script>
  <script src="../blockly/blocks/loops.js"></script>
  <script src="../blockly/blocks/math.js"></script>
  <script src="../blockly/blocks/text.js"></script>
  <script src="../blockly/blocks/lists.js"></script>
  <script src="../blockly/blocks/colour.js"></script>
  <script src="../blockly/blocks/variables.js"></script>
  <script src="../blockly/blocks/procedures.js"></script>
  <script src="../blockly/blocks/arduino/kniwwelino_blocks.js"></script>
  <script src="../blockly/blocks/arduino/io.js"></script>
  <script src="../blockly/blocks/arduino/map.js"></script>
  <script src="../blockly/blocks/arduino/procedures.js"></script>
  <script src="../blockly/blocks/arduino/serial.js"></script>
  <script src="../blockly/blocks/arduino/servo.js"></script>
  <script src="../blockly/blocks/arduino/spi.js"></script>
  <script src="../blockly/blocks/arduino/stepper.js"></script>
  <script src="../blockly/blocks/arduino/time.js"></script>
  <script src="../blockly/blocks/arduino/tone.js"></script>
  <script src="../blockly/blocks/arduino/variables.js"></script>
  <script src="../blockly/generators/arduino.js"></script>
  <script src="../blockly/generators/arduino/boards.js"></script>
  <script src="../blockly/generators/arduino/kniwwelino_code.js"></script>
  <script src="../blockly/generators/arduino/io.js"></script>
  <script src="../blockly/generators/arduino/lists.js"></script>
  <script src="../blockly/generators/arduino/logic.js"></script>
  <script src="../blockly/generators/arduino/loops.js"></script>
  <script src="../blockly/generators/arduino/map.js"></script>
  <script src="../blockly/generators/arduino/math.js"></script>
  <script src="../blockly/generators/arduino/procedures.js"></script>
  <script src="../blockly/generators/arduino/serial.js"></script>
  <script src="../blockly/generators/arduino/servo.js"></script>
  <script src="../blockly/generators/arduino/spi.js"></script>
  <script src="../blockly/generators/arduino/stepper.js"></script>
  <script src="../blockly/generators/arduino/text.js"></script>
  <script src="../blockly/generators/arduino/time.js"></script>
  <script src="../blockly/generators/arduino/tone.js"></script>
  <script src="../blockly/generators/arduino/variables.js"></script>

  <!-- Default language js files, user selection appended to head on load -->
  <script src="../blockly/msg/js/en.js"></script>
  <script src="msg/en.js"></script>
  <!--<script src="../blockly/msg/js/en_kniwwelino.js"></script>-->

  <script type="text/javascript">
    if (!navigator.doNotTrack) {
      //Begin Matomo code
      var _paq = _paq || [];
      /* tracker methods like "setCustomDimension" should be called before "trackPageView" */
      _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
      _paq.push(['trackPageView']);
      _paq.push(['enableLinkTracking']);
      (function() {
        var u="https://doku.kniwwelino.lu/piwik/";
        _paq.push(['setTrackerUrl', u+'piwik.php']);
        _paq.push(['setSiteId', '2']);
        var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
        g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
      })();
      //End Matomo Code
    }
  </script>

</head>

<body>
<script>
    // browser minimum requirements
    let featuresAvailability = {
        es6: (function() {
            try { new Function("(a = 0) => a"); }
            catch (err) { return false; }
            return true;
        })()
    };
    let missingFeatures = Object.getOwnPropertyNames(featuresAvailability).filter(function(name) { return !featuresAvailability[name]; });
    if (missingFeatures.length) {
        console.log("missing features", missingFeatures);
        var msg = "Your browser is not supported!\nYour browser seems too old, please upgrade it or try another one";
        alert(msg);
        document.write("<style>body * { display: none; } #min_requirements_failed_error_msg{ display: block !important; }  </style>");
        var p = document.createElement('p');
        p.appendChild(document.createTextNode(msg));
        p.id="min_requirements_failed_error_msg";
        document.querySelector('body').appendChild(p);
    }
</script>  <!-- Horizontal Navigation bar -->
  <nav class="nav-fixed page-header">
    <div class="nav-wrapper container">
			<a class="button-collapse" href="#" data-activates="slide-out" id="button-collapse" onclick="if(_paq)_paq.push(['trackEvent', 'SideMenu', 'toggle']);"><i class="mdi-navigation-menu left"></i></a>
      <img src="./img/nav_logo.png" class="hide-on-small"/>
      <a id="logo-container" class="brand-logo">
        <!--<span class="app_title translatable_title">Kniwwelino:</span>-->
        <!-- Sketch name editable text field -->
        <span class="sketch_name_wrapper">
          <i class="mdi-image-edit sketch_name_icon"></i>
          <input id="sketch_name" class="sketch_name" type="text">
        </span>
      </a>
      <!-- Horizontal Navbar links only shown on large resolutions -->
			<ul id="nav-mobile" class="right">

				<li><select name="select_kniwwelino" id="select_kniwwelino" class="manageKniwwelino browser-default input-field"></select></li>
				<li><a id="button_manageKniwwelino" class="modal-trigger" href="#manageKniwwelino" onclick="if(_paq)_paq.push(['trackEvent', 'Kniwwelino', 'manage']);"><i class="mdi-action-settings"></i></a></li>
        <!-- <li class="hide-on-med-and-down"><a href="#" id="button_load"><span class="translatable_open">Open</span><i class="mdi-file-file-upload left"></i></a></li>
        <li class="hide-on-med-and-down"><a href="#" id="button_save"><span class="translatable_save">Save</span><i class="mdi-file-file-download left"></i></a></li> -->
        <li class="hide-on-med-and-down"><a href="#" id="button_delete" onclick="if(_paq)_paq.push(['trackEvent', 'Kniwwelino', 'delete']);"><i class="mdi-action-delete"></i></a></li>
				<!-- <li><a href="#" id="button_load"><i class="mdi-file-file-upload"></i></a></li>
        <li><a href="#" id="button_save"><i class="mdi-file-file-download"></i></a></li>
        <li><a href="#" id="button_delete"><i class="mdi-action-delete"></i></a></li> -->

				<!-- <li class="hide-on-med-and-down"><select name="settings_language" id="language" class="manageKniwwelino browser-default input-field"></select></li> -->
      </ul>
    </div>
  </nav>

	<ul id="slide-out" class="side-nav">
    <li class="logo"><img src="img/sidenav_header.png" alt="Kniwwelino block image"></li>
    <li class="no-padding">
      <ul>
        <li id="menu_load"><a href="#" onclick="if(_paq)_paq.push(['trackEvent', 'SideMenu', 'load_xml']);"><span class="translatable_open">Open</span><i class="mdi-file-file-upload left"></i></a></li>
        <li id="menu_save"><a href="#" onclick="if(_paq)_paq.push(['trackEvent', 'SideMenu', 'save_xml']);"><span class="translatable_save">Save</span><i class="mdi-file-file-download left"></i></a></li>
        <li id="menu_delete"><a href="#" onclick="if(_paq)_paq.push(['trackEvent', 'SideMenu', 'delete']);"><span class="translatable_deleteAll">Delete All</span><i class="mdi-action-delete left"></i></a></li>
        <li id="menu_button_manageKniwwelino"><a class="modal-trigger" href="#manageKniwwelino" onclick="if(_paq)_paq.push(['trackEvent', 'SideMenu', 'manage']);"><span class="translatable_manageKniwwelino">My Kniwwelino</span><i class="mdi-action-settings left"></i></a></li>
        <li id="menu_bug"><a id="dokuURL" href="http://doku.kniwwelino.lu/" target="_blank"><span class="translatable_documentation">Documentation</span><i class="mdi-action-help left"></i></a></li>
        <li id="menu_tuto"><a class="modal-trigger" href="#tutorialMenu" onclick="if(_paq)_paq.push(['trackEvent', 'SideMenu', 'tuto']);"><span class="translatable_tutorial">Tutorial</span><i class="mdi-social-school left"></i></a></li>
        <li id="menu_bug"><a id="bugreportURL" href="https://doku.kniwwelino.lu/en/feedback" target="_blank"><span class="translatable_reportBug">Report Bug</span><i class="mdi-action-bug-report left"></i></a></li>
				<li><select name="settings_language" id="menu_language" class="browser-default input-field"></select></li>

			</ul>
    <!-- <li class="no-padding">
      <ul class="collapsible collapsible-accordion">
        <li>
          <div class="collapsible-header"><span class="translatable_language">Language</span><i class="mdi-navigation-arrow-drop-down"></i></div>
          <div class="collapsible-body">
            <ul>
              <li id="menu_example_1"><a href="#!">Best Friends</a></li>
              <li id="menu_example_2"><a href="#!">Rock Paper Scissors</a></li>
            </ul>
          </div>
        </li>
      </ul>
    </li> -->
    <li class="no-padding side-menu-end">&nbsp;</li>
  </ul>


  <!-- Content -->
  <div class="container" id ="container">
    <div class="row">
      <div id="blocks_workspace" class="col s12 m12 l8" style="position:relative; width: calc(100% - 0.75rem);">
        <!-- Toolbox visibility button -->
        <a id="button_toggle_toolbox" class="waves-effect waves-light btn-flat button_toggle_toolbox_off" style="display: none" onclick="if(_paq)_paq.push(['trackEvent', 'Kniwwelino', 'toggleToolbox']);"><i class="fa fa-angle-double-right" id="button_toggle_toolbox_icon"></i><span class="translatable_advanced" id="toggle_toolbox_text"> enable expert</span></a>
        <!-- Arduino IDE action buttons -->
        <div id="ide_buttons_wrapper">
          <a id="button_ide_large" class="waves-effect waves-light waves-circle z-depth-1-half arduino_orange" onclick="if(_paq)_paq.push(['trackEvent', 'Kniwwelino', 'upload']);"><i id="button_ide_large_icon" class="mdi-av-play-arrow"></i></a>
					<div id="button_ide_large_spinner" class="preloader-wrapper active ide_loader" style="display:none">
					 <div class="spinner-layer spinner-orange">
						 <div class="circle-clipper left">
							 <div class="circle"></div>
						 </div><div class="gap-patch">
							 <div class="circle"></div>
						 </div><div class="circle-clipper right">
							 <div class="circle"></div>
						 </div>
					 </div>
					 <div class="spinner-layer spinner-dark-teal">
						 <div class="circle-clipper left">
							 <div class="circle"></div>
						 </div><div class="gap-patch">
							 <div class="circle"></div>
						 </div><div class="circle-clipper right">
							 <div class="circle"></div>
						 </div>
					 </div>
					 <div class="spinner-layer spinner-yellow">
						 <div class="circle-clipper left">
							 <div class="circle"></div>
						 </div><div class="gap-patch">
							 <div class="circle"></div>
						 </div><div class="circle-clipper right">
							 <div class="circle"></div>
						 </div>
					 </div>
					 <div class="spinner-layer spinner-light-teal">
						 <div class="circle-clipper left">
							 <div class="circle"></div>
						 </div><div class="gap-patch">
							 <div class="circle"></div>
						 </div><div class="circle-clipper right">
							 <div class="circle"></div>
						 </div>
					 </div>
				 </div>
        </div>
        <!-- Blockly Panel -->
        <div class="card-panel white" style="padding: 0">
          <div id="blocks_panel" class="content blocks_panel_large">
            <div id="content_blocks" class="content z-depth-1"></div>
          </div>
        </div>
      </div>
      <div class="col s12 m12 l4" id="sidebar">
          <div id="codesidebar">
            <ul class="collapsible z-depth-1" data-collapsible="accordion">
              <li>
                <div class="sourcecode collapsible-header active waves-effect waves-teal" id="arduino_collapsible_header">
                  <span class="collapsible_logo">{ }</span>
                  <span class="translatable_arduinoSourceCode">Arduino Source Code</span>
                </div>
                <div class="collapsible-body" style="position:relative" id="arduino_collapsible_body">
    							<a id="download_arduino" class="btn btn-floating btn-large waves-effect waves-light blue right z-depth-1-half"  onclick="if(_paq)_paq.push(['trackEvent', 'CodeSidebar', 'downloadArduino']);"><i class="mdi-file-file-download"></i></a>
                  <pre id="content_arduino" class="content content_height_transition content_arduino_large"></pre>
                </div>
              </li>
              <li>
                <div class="sourcecode collapsible-header waves-effect waves-teal" id="xml_collapsible_header">
                  <span class="collapsible_logo">&#60; &#62;</span>
                  <span class="translatable_blocksXml">Blocks XML</span>
                </div>
                <div class="collapsible-body" style="position:relative" id="xml_collapsible_body">
                  <a id="button_load_xml" class="btn-floating btn-large waves-effect waves-light arduino_teal z-depth-1-half" onclick="if(_paq)_paq.push(['trackEvent', 'CodeSidebar', 'manualUpdateXML']);"><i class="mdi-action-extension"></i></a>
                  <textarea id="content_xml" class="content content_height_transition content_xml_large" wrap="soft"></textarea>
                </div>
              </li>
            </ul>
          </div>
          <div id="tutoSidebar" class="card-panel">
            <a id="tutoButtonValidate" class="button_ide_large waves-effect waves-light waves-circle z-depth-1-half arduino_orange tutoButton tutoButtonValidate hide" onclick="if(_paq)_paq.push(['trackEvent', 'Tutorial', 'validate']);"><i class="mdi-navigation-check"></i></a>
            <div id="tuto_area" class="hide">
                <i class="mdi-social-school left"></i>
                <h5></h5>
                <div>
                    <a id="tutoButtonBack" class="button_ide_large waves-effect waves-light waves-circle z-depth-1-half tutoButton arduino_orange tutoNavButton" onclick="if(_paq)_paq.push(['trackEvent', 'Tutorial', 'back']);"><i class="mdi-navigation-chevron-left"></i></a>
                    <p id="tutoStepTitle"><span class="translatable_tutoStepTitle">Step: </span><span id="tutoStepIndex"></span></p>
                    <a id="tutoButtonNext" class="button_ide_large waves-effect waves-light waves-circle z-depth-1-half tutoButton arduino_orange tutoNavButton" onclick="if(_paq)_paq.push(['trackEvent', 'Tutorial', 'next']);"><i class="mdi-navigation-chevron-right"></i></a>
                </div>
                <div id="tutoStep"></div>
            </div>
          </div>
      </div>
      <div id="expandCodeButtons">
            <a id="expandTutoButton" data-side-target-id="tutoSidebar" class="waves-effect waves-light btn" onclick="if(_paq)_paq.push(['trackEvent', 'TutoSidebar', 'toggle']);"><i class="fa fa-chevron-right fa-fw"></i><span class="translatable_tutorialExpandBt">Tutorial</span></a>
            <a id="expandSourceCodeButton" data-side-target-id="codesidebar" class="waves-effect waves-light btn" onclick="if(_paq)_paq.push(['trackEvent', 'CodeSidebar', 'toggle']);"><i class="fa fa-chevron-right fa-fw"></i><span class="translatable_seeArduinoSourceCode">Source Code</span></a>
      </div>
    </div>
  </div>


  <!-- IDE Output content -->
  <div class="ide_output_wrapper">
		<div id="copyright"><a id="copyright" href="#gen_copyright" class="modal-trigger"  onclick="if(_paq)_paq.push(['trackEvent', 'CopyRight', 'toggle']);">©2018 Luxembourg Institute of Science and Technology. Terms of use.</a></div>

		<ul class="collapsible ide_output_collapsible" data-collapsible="expandable">
      <li>
        <div id="ide_output_collapsible_header" class="collapsible-header ide_output_header_normal">
          <i class="mdi-action-swap-vert Medium" style="font-size: 2.2rem;"></i>
          <span class="translatable_arduinoOpMainTitle">Arduino IDE output</span>
        </div>
        <div class="collapsible-body">
          <div id="content_ide_output" class="content"></div>
        </div>
      </li>
    </ul>
  </div>
  <!-- <div id="ide_output_spacer"></div> -->

	<div id="gen_copyright" class="modal modal-fixed-footer" >
    <div class="modal-content">
			<div id="gen_copyright_body">Loading ...</div>
    </div>
    <div class="modal-footer">
      <a id="gen_copyright_ok_link" href="#" class="waves-effect btn-flat modal-close"><span class="translatable_okay">Okay</span></a>
    </div>
  </div>

  <!-- General Alert: Content is loaded using JavaScript to display alerts -->
  <div id="gen_alert" class="modal modal_small modal-fixed-footer">
    <div class="modal-content">
      <h5 id="gen_alert_title">Empty Alert</h5>
      <p><span id="gen_alert_body">Empty alert text</span></p>
    </div>
    <div class="modal-footer">
      <a id="gen_alert_ok_link" href="#" class="waves-effect btn-flat modal-close"><span class="translatable_okay">Okay</span></a>
      <a id="gen_alert_cancel_link" href="#" class="waves-effect btn-flat modal-close"><span class="translatable_cancel">Cancel</span></a>
    </div>
  </div>

  <!-- Prompt: Content is loaded using JavaScript to display input prompt -->
  <div id="gen_prompt" class="modal modal_small modal-fixed-footer">
    <div class="modal-content">
      <p><span id="gen_prompt_message">Prompt message</span></p>
      <p><input id="gen_prompt_input" value="test" /></p>
    </div>
    <div class="modal-footer">
      <a id="gen_prompt_ok_link" href="#" class="waves-effect btn-flat modal-close"><span class="translatable_okay">Okay</span></a>
      <a id="gen_prompt_cancel_link" href="#" class="waves-effect btn-flat modal-close"><span class="translatable_cancel">Cancel</span></a>
    </div>
  </div>

  <!-- Local Modal to manage Kniwwelino board. -->
  <div id="manageKniwwelino" class="modal modal-fixed-footer">
    <div class="modal-content">
      <h4><span class="translatable_manageKniwwelinoHeading">Manage your Kniwwelino boards</span></h4>
    	<div id="listKniwwelinosModal"><span class="translatable_manageKniwwelinoAdd">add Kniwwelino first</span></div>
    </div>
    <div class="modal-footer">
      <a href="#!" class="modal-action modal-close waves-effect waves-green btn-flat " id="button_closeManageKniwwelino" onclick="if(_paq)_paq.push(['trackEvent', 'ManageKniwwelino', 'close']);">
		<span class="translatable_close">Close</span>
	  </a>
    </div>
  </div>

  <!-- Local Modal to select a tutorial. -->
  <div id="tutorialMenu" class="modal modal-fixed-footer">
    <div class="modal-content">
      <h4><span class="translatable_tutorialMenuTitle">Select a tutorial</span></h4>
        <div id="tutorialMenuList"><span class="translatable_tutorialMenuListLoading">loading list…</span></div>
    </div>
    <div class="modal-footer">
      <a href="#!" class="modal-action modal-close waves-effect waves-green btn-flat " id="button_closeTutorialModal" onclick="if(_paq)_paq.push(['trackEvent', 'tutorialMenu', 'close']);">
        <span class="translatable_close">Close</span>
      </a>
    </div>
  </div>
  <!-- Local Modal for tutorial waiting loop -->
  <div id="waitingLoopModal" class="modal modal-fixed-footer">
    <div class="modal-content">
      <div id="waitingLoop"></div>
    </div>
  </div>
  <!-- Local Modal for tutorial analysis result -->
  <div id="tutorialAnalysisResult" class="modal modal-fixed-footer">
    <div class="modal-content">
      <h5 id="tutorialAnalysisResult_title">Title</h5>
      <p><span id="tutorialAnalysisResult_body">message</span></p>
    </div>
    <div class="modal-footer">
      <a href="#" class="waves-effect btn-flat modal-close"><span class="translatable_okay">Okay</span></a>
    </div>
  </div>

  <!-- jQuery and Materialize JS -->
  <script src="js_libs/jquery-2.1.3.min.js"></script>
  <script src="materialize/materialize.js"></script>
  <!-- FileSaver JS -->
  <script src="js_libs/FileSaver.min.js"></script>
  <!-- JS Diff -->
  <script src="js_libs/diff.js"></script>
  <!-- Prettify JS -->
  <script src="prettify/prettify.js"></script>
  <!-- Ardublockly app -->
  <script src="ardublocklyserver_ajax.js"></script>
  <script src="ardublockly_lang.js"></script>
  <script src="ardublockly_design.js"></script>
  <script src="ardublockly_toolbox.js"></script>
  <script src="ardublockly_blockly.js"></script>
  <script src="ardublockly.js"></script>
	<script src="ledmatrix.js"></script>
  <script>

    window.addEventListener('message', function load(event) {
      if(event.data  != Ardublockly.toolbox_helpers.TOOLBOX_LOADED_MSG_ID){
          return;
      }
      window.removeEventListener('message', load, false);
      Ardublockly.init();
    });
    window.onbeforeunload = function (e) {
        e = e || window.event;
        // For IE and Firefox prior to version 4
        if (e) {
            e.returnValue = 'Sure?';
        }
        // For Safari
        return 'Sure?';
    };
  </script>
  <script>
    var w = window;
    function onRequirejsReady() {
        // load bootstrap to support already loaded libs like jquery
        w.require(['tutorial/requirejs_bootstrap'],
            function (bootstrap) {
                bootstrap.init(function () {
                    // load tutorial
                    w.require(['tutorial'], function (tutorial) {
                        tutorial.init();
                    });
                });
            });
    }
    if (!w.requirejs) {
        // requirejs not yet suppported by some libs in this page; load it at the end to limit collision
        var script = w.document.createElement('script');
        script.setAttribute('type', 'text/javascript');
        script.setAttribute('src', 'js_libs/requirejs/require.js');
        script.addEventListener('load', function () {
            onRequirejsReady();
        });
        document.getElementsByTagName('head').item(0).appendChild(script);
    } else {
        onRequirejsReady();
    }
  </script>
</body>
</html>
